name: Run R script

on:
    workflow_dispatch:
        inputs:
            script:
                description: 'R script path relative to repository root'
                required: false
                default: 'tmp.R'

jobs:
    run-script:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
                uses: actions/checkout@v4

            - name: Setup R
                uses: r-lib/actions/setup-r@v2
                with:
                    r-version: 'latest'

            - name: Run requested R script
                shell: bash
                run: |
                    SCRIPT="${{ github.event.inputs.script }}"
                    if [ -z "$SCRIPT" ]; then
                        echo "No script provided" >&2
                        exit 1
                    fi
                    if [ ! -f "$SCRIPT" ]; then
                        echo "Script '$SCRIPT' not found" >&2
                        exit 1
                    fi
                    echo "Running R script: $SCRIPT"
                    Rscript "$SCRIPT"
